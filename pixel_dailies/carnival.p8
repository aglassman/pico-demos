pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
bell = {
	ringing=nil,
	draws=0,
	draw=function(self, x, y)
		
		if self.ringing then
			
			if self.draws  % 3 == 0 then	
				spr(1, x+1, y, 2, 2)
			else
				spr(1, x-1, y, 2, 2)
			end
			
			self.draws += 1
	
	
			print("ding!", 60, 0)
			if time() - self.ringing > 1 then
				self.ringing = nil
			end
		else
			spr(1, x, y, 2, 2)
		end

		
	end,
	
	ring=function(self)
		self.ringing=time()
	end
}

segment = {
	draw=function(self, x, y, top)
		if top then
			spr(40, x, y, 2, 2)
		else
			spr(33, x, y, 2, 2)
		end		
	end
}

base = {
	draw=function(self, x, y)
		spr(35, x, y, 4, 2)
	end
}

puck={
	dir=0,
	dy=0,
	draw=function(self, x, y)
		spr(39, x , y - self.dy, 1, 1)
		--print(self.dir, 10, 10)
		--print(self.dy, 10, 20)
	end
}

hammer={
	draw=function(self, x, y, hitting)
		if hitting then
			spr(7, x + 7, y + 24, 4, 2)
		else
			spr(11, x, y, 2, 4)
		end
	end,
}

game = {
	x=0,
	y=0,
	hitting=true,
	draw=function(self)
		for i=0,4 do
				segment:draw(
					self.x, 
					(i * 16) + 14 + self.y,
					i == 0)
		end	
		bell:draw(self.x, self.y)
		base:draw(
			self.x - 8, 
			self.y + 4 * 16 + 30)
	 puck:draw(
	 	self.x + 4,
	 	self.y + 4 * 16 + 26
	 )
	 hammer:draw(
	 	self.x - 23,
	 	self.y + 4 * 16 - 4,
	 	self.hitting
	 )		
	end
}

function _init()
	game.hitting = false
	game.x = 128 / 2 - 4
	game.y = 10
end

function _draw()
	cls()
	game:draw()
end

height = 74
speed  = 6

function _update()
	if(not game.hitting and btnp(üÖæÔ∏è)) then
		game.hitting = true
		puck.dir = 1
	end
	
	if puck.dir != 0 
		and puck.dy <= height 
		and puck.dy >= 0 then
		puck.dy+=(puck.dir * speed)
	elseif puck.dir == 1 
		and puck.dy > height then
		puck.dir = -1
		puck.dy = height
		bell:ring()
	elseif puck.dir != 0
		and (puck.dy >= height 
		or puck.dy < 0) then
		puck.dir = 0
		puck.dy = 0
		game.hitting = false
	end
	
end
__gfx__
00000000000005555550000000000000006888811888860000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000555555555500000000000006aaaa11aaaa60000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700005555555555550000000000006aaaa11aaaa600000000000000000000000000000000000000000000009000000f0000000000000000000000000000
00077000055555555555555000000000006aaaa11aaaa6000000000000000000000000000000f9f9f9f900000009f00440009000000000000000000000000000
00077000056555555555565000000000006aaaa11aaaa60000000000000000000000000000090949494f9000000f44244249f000000000000000000000000000
00700700565555555555556500000000006888811888860000000000000000000000000000000444444000000009944224449000000000000000000000000000
00000000675555555555557600000000006aaaa11aaaa6000000000000000000000000000000024444200000000f44444449f000000000000000000000000000
00000000675555567555557600000000006aaaaffaaaa60000000000444444444444444444444424424400000009944444449000000000000000000000000000
00000000675555516555557600000000006aaaa11aaaa6000000000044444444444444444444442442440000000f44422449f000000000000000000000000000
00000000675555555555557600000000006aaaa11aaaa60000000000000000000000000000000244442000000009942442449000000000000000000000000000
0000000056555555555555650000000000688881188886000000000000000000000000000000044444400000000f00044009f000000000000000000000000000
00000000056555555555565000000000006aaaa11aaaa600000000000000000000000000000f94949490f0000000900440090000000000000000000000000000
00000000055555555555555000000000006aaaa11aaaa6000000000000000000000000000000f9f9f9f900000000000440000000000000000000000000000000
00000000005555555555550000000000006aaaa11aaaa60000000000000000000000000000000000000000000000000440000000000000000000000000000000
00000000000555555555500000000000006aaaa11aaaa60000000000000000000000000000000000000000000000000440000000000000000000000000000000
00000000000005555550000000000000006888211288860000000000000000000000000000000000000000000000000440000000000000000000000000000000
00000000006888811888860000000000001111222211110000000000005555000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000001112222221110000000000005015000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000001112200221110000000000005105000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaaffaaaa60000000006661112000021116660000000005555000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000005551162000026115550000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000001112555521110000000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000011112655621110000000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006888811888860000000000011112222221111000000000000000000068888ff8888600000000000000000440000000000000000000000000000000
00000000006888811888860000000000011118888881111000000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000011118888881111000000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa60000000000111118888881111100000000000000000068888118888600000000000000000440000000000000000000000000000000
00000000006aaaaffaaaa6000000000011111116611111110000000000000000006aaaa11aaaa600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa6000000066611111111111111116660000000000000006aaaa11aaaa600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa6000000055555555555555555555550000000000000006aaaa11aaaa600000000000000000440000000000000000000000000000000
00000000006aaaa11aaaa6000000000000000000000000000000000000000000006aaaa11aaaa600000000000000000440000000000000000000000000000000
00000000006888811888860000000000000000000000000000000000000000000068888118888600000000000000000440000000000000000000000000000000
